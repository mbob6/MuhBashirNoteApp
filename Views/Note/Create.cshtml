@model NoteApp.Models.Note.CreateNoteViewModel
@{
    ViewData["Title"] = "Create New Note";
}

<style>
    .notebook-lines {
        background-color: #f8f9fa;
        line-height: 1.5;
        padding: 1rem;
    }

    .notebook-lines textarea {
        border: none;
        background-color: transparent;
        width: 100%;
        resize: none;
        font-size : 1.2rem;
        line-height: 1.5;
    }
</style>
<div class="container mt-5">
    <div class="row justify-content-center">
        <form asp-action="Create">
        <div class="col-md-8">
            <label asp-for="Title">Title</label>
            <input type="text" class="form-control" id="noteTitle" placeholder="Enter Title" asp-for="Title">
            <span asp-validation-for="Title" class="text-danger"></span>
            <div class="notebook-lines">
                <label asp-for="Content">Content</label>
                <textarea rows ="15" asp-for="Content" placeholder="Start typing your note..." id="noteContent"></textarea>
                <span asp-validation-for="Content" class="text-danger"></span>
            </div>

            @if (User.Identity.IsAuthenticated)
            {
                <div class="text-center mt-4">
                    <button class="btn btn-primary">Save Note</button>
                </div>
            }
            else
            {
                <div class="text-center mt-4">
                    <button class="btn btn-primary" asp-controller="Home" asp-action="Login" id="loginSave">Login to Save Note</button>
                </div>

                <div class="text-center mt-4">
                    <button class="btn btn-primary" asp-controller="Home" asp-action="SignUp" id="signupSave">Sign Up to Save Note</button>
                </div>
            }
            
        
            
        </div>
        </form>
    </div>
</div>

<script>
 /* var isLoggedIn = '@User.Identity.IsAuthenticated' === 'True';
  if (isLoggedIn) {
    // User is signed in
  } else {
    // User is not signed in
  }*/
    var note = {
           title: document.getElementById("noteTitle").value,
           content: document.getElementById("noteContent").value
    };

    var loginSave = document.getElementById("loginSave");
    var signupSave = document.getElementById("signupSave");
    var isLoggedIn = '@User.Identity.IsAuthenticated' === 'True';

    loginSave.addEventListener("click", saveNote);
    signupSave.addEventListener("click", saveNote);

    if(isLoggedIn)
    {
        retrieveNote();
    }

    function saveNote() {
        localStorage.setItem("note", JSON.stringify(note));         
    } 

    function retrieveNote() {
        var note = JSON.parse(localStorage.getItem("note"));
        document.getElementById("noteTitle").value = note.title;
        document.getElementById("noteContent").value = note.content;

        localStorage.removeItem("note");
    };

</script>

@*@section Scripts {
    @await Html.PartialAsync("_ValidationScriptsPartial")
}*@
